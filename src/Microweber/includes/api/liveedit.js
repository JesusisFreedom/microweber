mw.isDrag=!1,mw.resizable_row_width=!1,mw.mouse_over_handle=!1,mw.external_content_dragged=!1,mw.have_new_items=!1,mw.dragCurrent=null,mw.currentDragMouseOver=null,mw.mouseDownOnEditor=!1,mw.mouseDownStarted=!1,mw.SmallEditorIsDragging=!1,mw.states={},mw.dropables={prepare:function(){var a=document.createElement("div");a.className="mw_dropable",a.innerHTML='<span class="mw_dropable_arr"></span>',document.body.appendChild(a),mw.dropable=$(a),mw.dropable.bind("mouseenter",function(){$(this).hide()})},display:function(a){var a=$(a),b=a.offset(),c=a.outerWidth(),d=a.outerHeight();mw.drop_regions.global_drop_is_in_region||mw.dropable.css({top:b.top+d,left:b.left,width:c})},set:function(a,b,c,d){a==="top"?(mw.top_half=!0,mw.dropable.css({top:b.top-2,left:b.left,height:2,width:d}),mw.dropable.data("position","top"),mw.dropable.addClass("mw_dropable_arr_up")):a==="bottom"?(mw.top_half=!1,mw.dropable.css({top:b.top+c+2,left:b.left,height:2,width:d}),mw.dropable.data("position","bottom"),mw.dropable.removeClass("mw_dropable_arr_up"),mw.dropable.removeClass("mw_dropable_arr_rigt")):a==="left"?(mw.dropable.data("position","left"),mw.dropable.css({top:b.top,height:c,left:b.left,width:2})):a==="right"&&(mw.dropable.data("position","right"),mw.dropable.addClass("mw_dropable_arr_rigt"),mw.dropable.css({top:b.top,left:b.left+d,height:c,width:2}))}},$(document).ready(function(){mw.drag.create(),$(mwd.body).keyup(function(a){mw.$(".mw_master_handle").css({left:"",top:""})}),$(mwd.body).bind("keydown",function(a){a.keyCode==83&&a.ctrlKey&&(mw.e.cancel(a,!0),mw.drag.save(mwd.getElementById("main-save-btn")))}),mw.edits=mw.$(".edit"),mw.edits.mouseleave(function(a){if(mw.isDrag){var b=$(this),c=b.offset(),d=b.outerHeight(),e=b.outerWidth();a.pageX>c.left&&a.pageX<c.left+e&&(mw.currentDragMouseOver=this,c.top+d<a.pageY?(mw.dropables.set("top",c,d,e),mw.dropable.show()):(mw.dropables.set("bottom",c,d,e),mw.dropable.show())),mw.dropable.addClass("mw_dropable_onleaveedit")}}),$(window).bind("onDragHoverOnEmpty",function(a,b){if($.browser.webkit){var c=$(b);c.addClass("hover"),c.hasClass("mw-webkit-drag-hover-binded")||(c.addClass("mw-webkit-drag-hover-binded"),c.mouseleave(function(){c.removeClass("hover")}))}});var a=mwd.querySelectorAll('[field="title"]'),b=a.length,c=0;for(;c<b;c++)$(a[c]).addClass("nodrop");$(mwd.body).bind("mousedown mouseup",function(a){a.type=="mousedown"?!mw.tools.hasClass(a.target,"ui-resizable-handle")&&!mw.tools.hasParentsWithClass(a.target,"ui-resizable-handle")?mw.tools.addClass(mwd.body,"state-element"):mw.tools.removeClass(mwd.body,"state-element"):mw.tools.removeClass(mwd.body,"state-element")})}),hasAbilityToDropElementsInside=function(a){var b=/^(span|h[1-6]|hr|ul|ol|input|table|b|em|i|a|img|textarea|br|canvas|font|strike|sub|sup|dl|button|small|select|big|abbr|body)$/i;if(typeof a=="string")return!b.test(a);var c=b.test(a.nodeName);return c?!1:mw.tools.hasParentsWithClass(a,"module")?mw.tools.hasParentsWithClass(a,"edit")?!0:!1:mw.tools.hasClass(a,"module")?!1:!0},mw.drag={noop:mwd.createElement("div"),create:function(){mw.top_half=!1;var a=mwd.body.querySelectorAll(".edit"),b=a.length,c=0;for(;c<b;c++){var d=a[c].querySelectorAll("p,div,h1,h2,h3,h4,h5,h6"),e=0,f=d.length;for(;e<f;e++){var g=d[e],h=g.className;!mw.tools.hasParentsWithClass(g,"module")&&!mw.tools.hasClass(h,"module")&&!mw.tools.hasClass(h,"mw-col")&&!mw.tools.hasClass(h,"mw-row")&&mw.tools.addClass(g,"element")}}mw.$("#live_edit_toolbar_holder .module").removeClass("module"),$(mwd.body).mousemove(function(a){mw.tools.removeClass(this,"isTyping");if(!mw.settings.resize_started){mw.mouse={x:a.pageX,y:a.pageY},mw.mm_target=a.target,mw.$mm_target=$(mw.mm_target);if(!mw.isDrag){if(mw.mouse.x%2===0){mw.$mm_target.hasClass("element")&&!mw.$mm_target.hasClass("module")&&!mw.tools.hasParentsWithClass(mw.mm_target,"module")?$(window).trigger("onElementOver",mw.mm_target):mw.$mm_target.parents(".element").length>0&&!mw.tools.hasParentsWithClass(mw.mm_target,"module")?$(window).trigger("onElementOver",mw.$mm_target.parents(".element:first")[0]):mw.mm_target.id!="mw_handle_element"&&mw.$mm_target.parents("#mw_handle_element").length==0&&$(window).trigger("onElementLeave",mw.mm_target),mw.$mm_target.hasClass("module")?$(window).trigger("onModuleOver",mw.mm_target):mw.$mm_target.parents(".module").length>0?$(window).trigger("onModuleOver",mw.tools.firstParentWithClass(mw.mm_target,"module")):mw.mm_target.id!="mw_handle_module"&&mw.$mm_target.parents("#mw_handle_module").length==0&&$(window).trigger("onModuleLeave",mw.mm_target);if(mw.mm_target.tagName==="IMG"){var b=mw.tools.parentsOrder(mw.mm_target,["edit","module"]);if(b.module==-1||b.edit>-1&&b.edit<b.module)mw.tools.hasParentsWithClass(mw.mm_target,"mw-defaults")||$(window).trigger("onImageOver",mw.mm_target)}mw.$mm_target.hasClass("mw-row")?$(window).trigger("onRowOver",mw.mm_target):mw.$mm_target.parents(".mw-row").length>0?$(window).trigger("onRowOver",mw.$mm_target.parents(".mw-row:first")[0]):mw.mm_target.id!="mw_handle_row"&&mw.$mm_target.parents("#mw_handle_row").length==0&&$(window).trigger("onRowLeave",mw.mm_target),mw.isDragItem(mw.mm_target)&&mw.$mm_target.parent().hasClass("element")||mw.mm_target.className.contains("mw_item")?$(window).trigger("onItemOver",mw.tools.firstParentWithClass(mw.mm_target,"edit")):mw.$mm_target.parents(".mw_item").length>0?$(window).trigger("onItemOver",mw.$mm_target.parents(".mw_item")[0]):mw.mm_target.id!="items_handle"&&mw.$mm_target.parents("#items_handle").length==0&&$(window).trigger("onItemLeave",mw.mm_target),mw.$mm_target.parents(".edit,.mw_master_handle").length==0&&(!!mw.$mm_target.hasClass(".edit")||!!mw.$mm_target.hasClass("mw_master_handle"))}mw.image._dragTxt(a)}else{mw.$mm_target.hasClass("empty-element")?$(window).trigger("onDragHoverOnEmpty",mw.mm_target):$(mw.mm_target.parentNode).hasClass("empty-element")?$(window).trigger("onDragHoverOnEmpty",mw.mm_target.parentNode):$(mw.mm_target.parentNode).hasClass("mw-empty")?$(window).trigger("onDragHoverOnEmpty",mw.mm_target.parentNode):$(mw.mm_target).hasClass("mw-empty")&&$(window).trigger("onDragHoverOnEmpty",mw.mm_target.parentNode);if(!mw.tools.hasParentsWithClass(mw.mm_target,"edit")&&!mw.tools.hasClass(mw.mm_target.className,"edit"))mw.mm_target=mw.drag.noop,mw.$mm_target=$(mw.drag.noop),mw.dropable.removeClass("mw_dropable_onleaveedit");else{var b=mw.tools.parentsOrder(mw.mm_target,["edit","module"]);!(b.module>-1&&b.edit>b.module)}if(mw.tools.hasParentsWithClass(mw.mm_target,"module")&&mw.tools.hasParentsWithClass(mw.mm_target,"edit"))mw.currentDragMouseOver=mw.tools.lastParentWithClass(mw.mm_target,"module");else if(mw.tools.hasClass(mw.mm_target.className,"module"))mw.currentDragMouseOver=mw.mm_target;else if(mw.$mm_target.hasClass("element")||mw.$mm_target.hasClass("empty-element")||mw.$mm_target.hasClass("mw-empty")||mw.$mm_target.hasClass("mw-row")||mw.$mm_target.hasClass("module")||mw.tools.hasParentsWithClass(mw.mm_target,"element")||mw.tools.hasParentsWithClass(mw.mm_target,"module")||mw.isDragItem(mw.mm_target)||mw.mm_target.tagName=="IMG")mw.$mm_target.hasClass("module")?mw.currentDragMouseOver=mw.mm_target:mw.tools.hasParentsWithClass(mw.mm_target,"module")?mw.currentDragMouseOver=mw.tools.firstParentWithClass(mw.mm_target,"module"):!mw.mm_target.className.contains("ui-")&&!mw.tools.hasParentsWithClass(mw.mm_target,"ui-draggable-dragging")&&(mw.tools.hasParentsWithClass(mw.mm_target,"edit")&&!mw.tools.hasParentsWithClass(mw.mm_target,"no-drop")&&!mw.$mm_target.hasClass("no-drop")?(mw.tools.hasClass(mw.mm_target.className,"mw-col")||mw.tools.hasClass(mw.mm_target.className,"mw-col-container")?mw.currentDragMouseOver=mw.tools.firstParentWithClass(mw.mm_target,"mw-row"):mw.currentDragMouseOver=mw.mm_target,(mw.$mm_target.hasClass("empty-element")||mw.$mm_target.hasClass("mw-empty"))&&mw.dropable.removeClass("mw_dropable_onleaveedit")):mw.tools.hasClass(mw.mm_target.className,"edit")?(mw.currentDragMouseOver=mw.mm_target,mw.tools.hasClass(mw.mm_target.className,"nodrop-around")&&(mw.currentDragMouseOver=null)):mw.currentDragMouseOver=null)}if(mw.isDrag&&mw.currentDragMouseOver!=null){if(mw.tools.hasClass("nodrop",mw.currentDragMouseOver.className)||mw.tools.hasParentsWithClass(mw.currentDragMouseOver,"nodrop")||mw.currentDragMouseOver.getAttribute("field")==="title")mw.currentDragMouseOver=mw.drag.noop;mw.drop_regions.init(mw.currentDragMouseOver,a,function(a){});var c=$(mw.currentDragMouseOver);$(".ui-draggable-dragging").show();if(c.hasClass("ui-draggable-dragging")||mw.tools.hasParentsWithClass(mw.currentDragMouseOver,"ui-draggable-dragging"))return!1;var d=$(this),e=c.offset(),f=c.outerHeight(),g=c.width();mw.drop_regions.global_drop_is_in_region?(mw.dropable.addClass("mw_dropable_vertical"),mw.drop_regions.which=="left"?mw.dropables.set("left",e,f):mw.dropables.set("right",e,f,g)):(mw.dropable.removeClass("mw_dropable_vertical"),mw.dropable.removeClass("mw_dropable_arr_rigt"),a.pageY>e.top+f/2?mw.dropables.set("bottom",e,f,g):mw.dropables.set("top",e,f,g)),c.hasClass("element")||mw.tools.hasParentsWithClass(mw.currentDragMouseOver,"mw-row")||mw.tools.hasClass(mw.currentDragMouseOver.className,"module")||mw.tools.hasParentsWithClass(mw.currentDragMouseOver,"module")||mw.tools.hasParentsWithClass(mw.currentDragMouseOver,"element")?c.hasClass("empty-element")||c.hasClass("mw-empty")?mw.dropable.hide():mw.dropable.show():mw.dropable.hide()}}$(".currentDragMouseOver").removeClass("currentDragMouseOver"),$(mw.currentDragMouseOver).addClass("currentDragMouseOver")}),mw.dropables.prepare(),mw.drag.fix_placeholders(!0),mw.drag.fixes(),mw.drag.init(),mw.resizable_columns(),$(mwd.body).mouseup(function(a){mw.mouseDownStarted=!1,mw.isDrag&&mw.dropable.is(":hidden")&&$(".ui-draggable-dragging").css({top:0,left:0}),$(this).removeClass("not-allowed"),$(".toolbar_bnav_hover").length==0&&$(".ts_main_ul").length!=0&&($(".ts_main_ul .ts_action").invisible(),$(".ts_main_ul .ts_action").css({left:"100%",top:0})),!a.target.hasAttribute("field")}),$(mwd.body).mousedown(function(a){var b=a.target;$(b).hasClass("image_free_text")&&(mw.image._dragcurrent=b,mw.image._dragparent=b.parentNode,mw.image._dragcursorAt.x=a.pageX-b.offsetLeft,mw.image._dragcursorAt.y=a.pageY-b.offsetTop,b.startedY=b.offsetTop-b.parentNode.offsetTop,b.startedX=b.offsetLeft-b.parentNode.offsetLeft),$(".desc_area_hover").length==0&&$(".desc_area").hide(),mw.tools.hasClass(a.target.className,"mw-open-module-settings")&&mw.drag.module_settings(),!mw.tools.hasParentsWithTag(a.target,"TABLE")&&!mw.tools.hasParentsWithClass(a.target,"mw-inline-bar")&&($(mw.inline.tableControl).hide(),mw.$(".tc-activecell").removeClass("tc-activecell")),mw.tools.hasParentsWithClass(b,"nodrop")||mw.tools.hasClass(b.className,"nodrop")?mw.wysiwyg.disableEditors():mw.wysiwyg.enableEditors()}),$(window).bind("onElementOver",function(a,b){var c=$(b);if(b.textContent.length<2&&b.nodeName!=="IMG")return!1;var d=c.offset(),e=c.width(),f=parseFloat(c.css("paddingLeft"));$(mw.handle_element).css({top:d.top-17,left:d.left,width:e}),$(mw.handle_element).data("curr",b),b.id==""?b.id="row_"+mw.random():"",mw.dropable.removeClass("mw_dropable_onleaveedit")}),$(window).bind("onModuleOver",function(a,b){var c=mw.tools.parentsOrder(b,["edit","module"]);c.edit==-1||c.module>-1&&c.edit>c.module?(mw.$("#mw_handle_module .mw-sorthandle-moveit").hide(),mw.$("#mw_handle_module .mw_edit_delete").hide()):(mw.$("#mw_handle_module .mw-sorthandle-moveit").show(),mw.$("#mw_handle_module .mw_edit_delete").show());var d=$(b),e=d.dataset("mw-title");e!=""?$(mw.handle_module).find(".mw-element-name-handle").html(e):$(mw.handle_module).find(".mw-element-name-handle").html("Settings"),$(mw.handle_module).find(".mw_edit_delete").dataset("delete",b.id);var f=d.offset(),g=d.width(),h=parseFloat(d.css("paddingLeft"));$(mw.handle_module).css({top:f.top-17,left:f.left+h,width:g}),$(mw.handle_module).data("curr",b),b.id==""?b.id="row_"+mw.random():""}),$(window).bind("onRowOver",function(a,b){var c=$(b),d=c.offset(),e=c.width(),f=parseFloat(c.css("paddingLeft"));$(mw.handle_row).css({top:d.top-35,left:d.left,width:e}),$(mw.handle_row).data("curr",b);var g=$(b).children(".mw-col").length;mw.$("a.mw-make-cols").removeClass("active"),mw.$("a.mw-make-cols").eq(g-1).addClass("active"),b.id==""?b.id="row_"+mw.random():""}),$(window).bind("onItemOver",function(a,b){if(b===!1)return!1;var c=$(b),d=c.offset(),e=parseFloat(c.css("paddingLeft"));$(mw.handle_item).css({top:d.top,left:d.left+e}),$(mw.handle_item).data("curr",b)}),mw.$("#mw_handle_row,#mw_handle_module,#mw_handle_element,#items_handle").hover(function(){var a=$(this).data("curr");$(a).addClass("element-active"),$(this).addClass(this.id+"hover")},function(){var a=$(this).data("curr");$(a).removeClass("element-active"),$(this).removeClass(this.id+"hover"),$(this).css({top:"",left:""})}),$(window).bind("onAllLeave",function(a,b){$("#mw_handle_row,#mw_handle_module,#mw_handle_element").css({top:"",left:""})}),$(window).bind("onElementLeave",function(a,b){$(mw.handle_element).css({top:"",left:""})}),$(window).bind("onModuleLeave",function(a,b){$(mw.handle_module).css({top:"",left:""})}),$(window).bind("onRowLeave",function(a,b){setTimeout(function(){mw.$("#mw_handle_row").hasClass("mw_handle_row_hover")&&$(mw.handle_row).css({top:"",left:""})},222)}),$(window).bind("onItemLeave",function(a,b){$(mw.handle_item).css({top:"",left:""})})},init:function(a,b){mw.handle_item||($(mwd.body).append(mw.settings.handles.module),$(mwd.body).append(mw.settings.handles.row),$(mwd.body).append(mw.settings.handles.element),$(mwd.body).append(mw.settings.handles.item),mw.handle_module=mwd.getElementById("mw_handle_module"),mw.handle_row=mwd.getElementById("mw_handle_row"),mw.handle_element=mwd.getElementById("mw_handle_element"),mw.handle_item="",$(mw.handle_element).mouseenter(function(){var a=$(this).data("curr");$(this).draggable("option","helper",function(){var b=$(a).clone(!0);return b.css({width:$(a).width(),height:$(a).height()}),b})}).click(function(){var a=$(this).data("curr");$(a).hasClass("element-current")||($(".element-current").removeClass("element-current"),a.tagName=="IMG"?$(window).trigger("onImageClick",a):$(window).trigger("onElementClick",a)),$(a).hasClass("module")||mw.wysiwyg.select_element($(a)[0])}),$(mw.handle_module).mouseenter(function(){var a=$(this).data("curr");$(this).draggable("option","helper",function(){var b=$(a).clone(!0);return b.css({width:$(a).width(),height:$(a).height()}),b})}).click(function(){var a=$(this).data("curr");$(a).hasClass("element-current")||$(window).trigger("onElementClick",a)}),$(mw.handle_row).mouseenter(function(){var a=$(this).data("curr");$(this).draggable("option","helper",function(){var b=$(a).clone(!0);return b.css({width:$(a).width(),height:$(a).height()}),b})}).click(function(){var a=$(this).data("curr");$(a).hasClass("element-current")||$(window).trigger("onElementClick",a)}),$(mw.handle_item).mouseenter(function(){var a=$(this),b=a.data("curr");b.id="item_"+mw.random(),a.draggable("option","helper",function(){var a=$(b).clone(!0);return a.css({width:$(b).width(),height:$(b).height()}),a})}).click(function(){var a=$(this).data("curr");$(a).hasClass("element-current")||$(window).trigger("onItemClick",a)}),$(mw.handle_element).draggable({handle:".mw-sorthandle-moveit",cursorAt:{top:-30},start:function(){mw.isDrag=!0;var a=$(mw.handle_element).data("curr");mw.dragCurrent=a,mw.dragCurrent.id==""?mw.dragCurrent.id="element_"+mw.random():"",$(mw.dragCurrent).invisible().addClass("mw_drag_current"),$(window).trigger("onAllLeave"),mw.drag.fix_placeholders(),$(mwd.body).addClass("dragStart"),$(mw.image_resizer).removeClass("active"),$(mw.tools.firstParentWithClass(mw.dragCurrent,"edit")).addClass("changed"),mw.smallEditor.css("visibility","hidden"),mw.smallEditorCanceled=!0},stop:function(){$(mwd.body).removeClass("dragStart")}}),$(mw.handle_module).draggable({handle:".mw-sorthandle-moveit",cursorAt:{top:-30},start:function(){mw.isDrag=!0;var a=$(mw.handle_module).data("curr");mw.dragCurrent=a,mw.dragCurrent.id==""?mw.dragCurrent.id="module_"+mw.random():"",$(mw.dragCurrent).invisible().addClass("mw_drag_current"),$(window).trigger("onAllLeave"),mw.drag.fix_placeholders(),$(mwd.body).addClass("dragStart"),$(mw.image_resizer).removeClass("active"),$(mw.tools.firstParentWithClass(mw.dragCurrent,"edit")).addClass("changed"),mw.smallEditor.css("visibility","hidden"),mw.smallEditorCanceled=!0},stop:function(){$(mwd.body).removeClass("dragStart")}}),$(mw.handle_row).draggable({handle:".column_separator_title",cursorAt:{top:-30},start:function(){mw.isDrag=!0;var a=$(mw.handle_row).data("curr");mw.dragCurrent=a,mw.dragCurrent.id==""?mw.dragCurrent.id="row_"+mw.random():"",$(mw.dragCurrent).invisible().addClass("mw_drag_current"),$(window).trigger("onAllLeave"),mw.drag.fix_placeholders(),$(mwd.body).addClass("dragStart"),$(mw.image_resizer).removeClass("active"),$(mw.tools.firstParentWithClass(mw.dragCurrent,"edit")).addClass("changed"),mw.smallEditor.css("visibility","hidden"),mw.smallEditorCanceled=!0},stop:function(){$(mwd.body).removeClass("dragStart")}}),$(mw.handle_item).draggable({cursorAt:{top:-30},start:function(){mw.isDrag=!0;var a=$(mw.handle_item).data("curr");mw.dragCurrent=a,$(mw.dragCurrent).invisible().addClass("mw_drag_current"),$(window).trigger("onAllLeave"),mw.drag.fix_placeholders(),$(mwd.body).addClass("dragStart"),$(mw.image_resizer).removeClass("active"),$(mw.tools.firstParentWithClass(mw.dragCurrent,"edit")).addClass("changed")},stop:function(){$(mwd.body).removeClass("dragStart")}}),mw.drag.toolbar_modules()),mw.drag.the_drop()},toolbar_modules:function(a){var b=a||".modules-list li";mw.$(b).draggable({revert:!0,cursorAt:{top:-30},revertDuration:0,start:function(a,b){mw.isDrag=!0,mw.dragCurrent=mw.GlobalModuleListHelper,$(mwd.body).addClass("dragStart"),$(mw.image_resizer).removeClass("active")},stop:function(){mw.isDrag=!1,mw.pauseSave=!0;var a=this;$(mwd.body).removeClass("dragStart"),setTimeout(function(){mw.drag.load_new_modules(),mw.recommend.increase($(mw.dragCurrent).attr("data-module-name")),mw.drag.toolbar_modules(a)},200)}}),mw.$(b).mouseenter(function(){$(this).draggable("option","helper",function(){var a=$(this).clone(!0);return a.appendTo(mwd.body),mw.GlobalModuleListHelper=a[0],a[0]})}),mw.$(b).bind("click mousedown mouseup",function(a){a.preventDefault();if(a.type=="click")return!1;if(a.type=="mouseup"&&a.which==1&&!mw.isDrag&&mww.getSelection().rangeCount>0&&mwd.querySelector(".mw_modal")===null){var b=this.outerHTML;mw.wysiwyg.insert_html(b),mw.drag.load_new_modules()}})},the_drop:function(){$(mwd.body).hasClass("bup")||($(mwd.body).addClass("bup"),$(mwd.body).bind("mouseup",function(a){mw.image._dragcurrent=null,mw.image._dragparent=null;var b=mwd.getElementsByClassName("canvas-slider"),c=b.length,d=0;for(;d<c;d++)b[d].isDrag=!1;if(!mw.isDrag){var e=a.target;$(e).hasClass("element")?$(window).trigger("onElementClick",e):mw.tools.hasParentsWithClass(e,"element")&&$(window).trigger("onElementClick",$(e).parents(".element")[0]),$(e).hasClass("mw_item")?$(window).trigger("onItemClick",e):mw.tools.hasParentsWithClass(e,"mw_item")&&$(window).trigger("onItemClick",$(e).parents(".mw_item")[0]);if(e.tagName=="IMG"){var f=mw.tools.parentsOrder(mw.mm_target,["edit","module"]);if(f.module==-1||f.edit>-1&&f.edit<f.module)mw.tools.hasParentsWithClass(e,"mw-defaults")||$(window).trigger("onImageClick",e),mw.wysiwyg.select_element(e)}e.tagName=="BODY"&&$(window).trigger("onBodyClick",e)}mw.isDrag&&(mw.isDrag=!1,mw.tools.hasClass(mw.currentDragMouseOver,"edit")?mw.tools.addClass(mw.currentDragMouseOver,"changed orig_changed"):mw.tools.addClass(mw.tools.firstParentWithClass(mw.currentDragMouseOver,"edit"),"changed orig_changed"),mw.askusertostay=!0,$(mw.currentDragMouseOver).removeClass("currentDragMouseOver"),mw.$(".mw_dropable").hide(),setTimeout(function(){$(mw.dragCurrent).visibilityDefault().removeClass("mw_drag_current");if(mw.currentDragMouseOver===null)return!1;var b=$(mw.dragCurrent).prev(),c=$(mw.dragCurrent).next(),d=$(mw.dragCurrent).parent(),e=mw.dropable.data("position");mw.dropable.removeClass("mw_dropable_onleaveedit");if($(mw.currentDragMouseOver).hasClass("mw-empty"))return $(mw.currentDragMouseOver).before(mw.dragCurrent),!1;if($(mw.currentDragMouseOver).hasClass("empty-element"))return mw.tools.hasChildrenWithClass(mw.currentDragMouseOver.parentNode,"mw-col-container")?$(mw.currentDragMouseOver.parentNode).children(".mw-col-container:last").append(mw.dragCurrent):$(mw.currentDragMouseOver).before(mw.dragCurrent),!1;if($(mw.currentDragMouseOver).hasClass("edit"))return hasAbilityToDropElementsInside(mw.currentDragMouseOver)?e=="top"?$(mw.currentDragMouseOver).prepend(mw.dragCurrent):e=="bottom"&&$(mw.currentDragMouseOver).append(mw.dragCurrent):e=="top"?$(mw.currentDragMouseOver).before(mw.dragCurrent):e=="bottom"&&$(mw.currentDragMouseOver).after(mw.dragCurrent),!1;if($(mw.currentDragMouseOver).hasClass("module"))return e=="top"?$(mw.currentDragMouseOver).before(mw.dragCurrent):e=="bottom"?$(mw.currentDragMouseOver).after(mw.dragCurrent):e=="left"?__createRow(mw.currentDragMouseOver,mw.dragCurrent,e):e=="right"&&__createRow(mw.currentDragMouseOver,mw.dragCurrent,e),!1;if($(mw.currentDragMouseOver).hasClass("mw-free-element"))return $(mw.currentDragMouseOver).append(mw.dragCurrent),$(window).trigger("onFreeEnter",mw.currentDragMouseOver),!1;if(mw.currentDragMouseOver==null||mw.currentDragMouseOver.id===mw.dragCurrent.id)$(mw.dragCurrent).visibilityDefault().removeClass("mw_drag_current");else{var f=$(mw.currentDragMouseOver);mw.dragCurrent.tagName.toLowerCase()=="li"&&(mw.dragCurrent=$(mw.dragCurrent).clone(!0),$(mw.dragCurrent).removeAttr("id"));if(!f.hasClass("empty-element")){if(mw.currentDragMouseOver.parentNode!==null&&!hasAbilityToDropElementsInside(mw.currentDragMouseOver.parentNode.nodeName)){mw.currentDragMouseOver=mw.currentDragMouseOver.parentNode;var f=$(mw.currentDragMouseOver)}e=="top"?($(mw.dragCurrent).removeClass("mw_drag_float"),$(mw.dragCurrent).removeClass("mw_drag_float_right"),f.removeClass("mw_drag_float"),f.hasClass("edit")||dropInside(mw.currentDragMouseOver)?f.prepend(mw.dragCurrent):f.before(mw.dragCurrent)):e=="bottom"?($(mw.dragCurrent).removeClass("mw_drag_float"),$(mw.dragCurrent).removeClass("mw_drag_float_right"),f.removeClass("mw_drag_float"),f.hasClass("edit")||dropInside(mw.currentDragMouseOver)?f.append(mw.dragCurrent):f.after(mw.dragCurrent),$(mw.dragCurrent).addClass("clear")):e=="left"?($(mw.dragCurrent).removeClass("clear"),__createRow(f,mw.dragCurrent,e)):e=="right"&&__createRow(f,mw.dragCurrent,e)}if(b.length==0&&c.hasClass("empty-element")&&d.hasClass("temp_column")&&!f.hasClass("empty-element")){var g=d.parents(".mw-row").eq(0);d.remove(),g.find(".empty-element").remove(),g.replaceWith(g.find(".mw-col").html())}}mw.have_new_items==1&&mw.drag.load_new_modules(),$(mw.dragCurrent).show(),mw.drag.fixes(),setTimeout(function(){mw.drag.fix_placeholders()},40),mw.resizable_columns(),mw.dropable.hide(),$(mw.dragCurrent).parent().hasClass("element")||$(mw.dragCurrent).addClass("element"),$(mw.dragCurrent).css({width:"",height:""}),a.stopPropagation(),$(".currentDragMouseOver").removeClass("currentDragMouseOver"),mw.currentDragMouseOver=null,$(mw.currentDragMouseOver).removeClass("currentDragMouseOver")},77))}))},fixes:function(){mw.$(".edit .mw-col, .edit .mw-row").height("auto"),$(mw.dragCurrent).css({top:"",left:""}),setTimeout(function(){mw.$(".edit .mw-col").each(function(){var a=$(this);a.children().length==0||a.children(".empty-element").length>0||a.children(".ui-draggable-dragging").length>0?(a.height("auto"),a.height()<a.parent().height()?a.height(a.parent().height()):a.height("auto")):(a.children(".empty-element").height("auto"),a.height("auto"),a.parents(".mw-row:first").height("auto")),a.height("auto");var b=mw.tools.firstParentWithClass(this,"mw-row");!b||(b.style.height="auto"),mw.tools.fixDeniedParagraphHierarchy()})},222);var a=mwd.querySelectorAll("div.element"),b=a.length,c=0;if(b>0)for(;c<b;c++)a[c].querySelector("p,div,li,h1,h2,h3,h4,h5,h6")===null&&!mw.tools.hasClass(a[c].className,"nodrop")&&!mw.tools.hasClass(a[c].className,"mw-empty")&&(a[c].innerHTML='<p class="element">'+a[c].innerHTML+"</p>")},fix_placeholders:function(a,b){var b=b||".mw-row";a&&$(b).each(function(){var a=$(this);a.children("div.mw-col").each(function(){var a=$(this).children("div.empty-element");if(a.length==0){$(this).append('<div contenteditable="false" class="empty-element" id="mw-placeholder-'+mw.random()+'"><a class="delete_column" href="javascript:;" onclick="mw.delete_column(this);">Delete</a></div>');var a=$(this).children("div.empty-element")}})}),mw.$("div.empty-element").css({position:"absolute"}),mw.$("div.empty-element").parent().height("auto"),mw.$("div.empty-element").each(function(){var a=$(this),b=a.parents(".mw-row").eq(0).height(),c=a.parent().height();a.css({height:b-c,position:"relative"})})},edit_remove:function(){},fancynateLoading:function(a){mw.$(a).addClass("module_loading"),setTimeout(function(){$(a).addClass("module_activated"),setTimeout(function(){mw.$(a).removeClass("module_loading module_activated")},510)},150)},load_new_modules:function(a){mw.pauseSave=!0;var b=!1;mw.$(".edit .module-item").each(function(a){mw._({selector:this,done:function(a){mw.drag.fancynateLoading(a),mw.pauseSave=!1}},!0),b=!0}),mw.have_new_items==1&&(b=!0),b==1&&(mw.isDrag||typeof a=="function"&&a.call(this)),mw.have_new_items=!1},module_view:function(a){var b=mw.drag.module_settings(!1,a);return b},module_settings:function(a,b){return mw.tools.module_settings(a,b)},ModuleSettingsPopupLoaded:function(a){mw.$("#"+a+" .mw_option_field").bind("change blur",function(){var a=$(this).attr("data-refresh");if(a==undefined)var a=$(this).attr("data-reload");if(a==undefined)var a=$(this).parents(".mw_modal_container:first").attr("data-settings-for-module"),a="#"+a;var b=$(this).parents(".module:first").attr("data-type"),c=$(this).attr("data-module-id");if(c==undefined)var c=$(this).parents(".mw_modal_container:first").attr("data-settings-for-module");if(this.type==="checkbox"){var d="",e=mw.$('input[name="'+this.name+'"]');for(var f=0;f<e.length;f++)var g=e[f].value,d=e[f].checked==1?d===""?g:d+", "+g:d}else d=this.value;var h={option_key:$(this).attr("name"),option_group:c,option_value:d};b!=undefined&&(h.module=b),$.ajax({type:"POST",url:mw.settings.site_url+"api/save_option",data:h,success:function(){a!=undefined&&a!=""&&(a=a.toString(),window.mw!=undefined&&window.mw.reload_module!=undefined&&(window.mw.reload_module(a),window.mw.reload_module("#"+a)))}})})},load_module:function(a,b){var c={};c.module=a;var d=mw.settings.site_url+"api/module";$(b).load_modules(d,c,function(){window.mw_sortables_created=!1})},delete_element:function(a){var b=mw.is.obj(a)?$(a).data("curr").id:a;mw.tools.confirm(mw.settings.sorthandle_delete_confirmation_text,function(){b==""&&(b=mw.settings.element_id),$(mw.tools.firstParentWithClass(mw.$("#"+b)[0],"edit")).addClass("changed orig_changed"),mw.askusertostay=!0,mw.$("#"+b).addClass("mwfadeout"),setTimeout(function(){mw.$("#"+b).remove(),mw.$("#module-settings-"+b).remove(),$(mw.handle_module).css({left:"",top:""}),mw.drag.fix_placeholders(!0)},300)})},create_columns:function(a,b){if(!$(a).hasClass("active")){var c=$(mw.handle_row).data("curr").id;$(mw.handle_row).children(".mw-col").removeClass("temp_column"),$(mw.handle_row).find("a").removeClass("active"),$(a).addClass("active");var d=c!=""?c:mw.settings.mw-row_id;mw.settings.sortables_created=!1;var e=mw.$("#"+d).children(".mw-col").length;b==0&&(b=1),b=parseInt(b),e==0&&(e=1);if(b!=e){if(b>e){var f=e;for(;f<b;f++){var g=mwd.createElement("div");g.className="mw-col",g.innerHTML='<div class="mw-col-container"></div>',mw.$("#"+d).append(g),mw.drag.fix_placeholders(!0,"#"+d)}mw.resizable_columns()}else{var h=e-b;if(h>0){var i=document.createDocumentFragment(),j;mw.$("#"+d).children(".mw-col").each(function(a){a==b-1?j=$(this):a>b-1&&(this.querySelector(".mw-col-container")!==null&&mw.tools.foreachChildren(this,function(){mw.tools.hasClass(this.className,"mw-col-container")&&i.appendChild(this)}),$(this).remove())});var k=j.find(".mw-col-container"),l=i.childNodes,f=0,m=l.length;for(;f<m;f++){var n=l[f];mw.$(".empty-element, .ui-resizable-handle",n).remove(),k.append(n.innerHTML)}j.resizable("destroy"),mw.$("#"+d).children(".empty-element").remove(),mw.drag.fix_placeholders(!0,"#"+d)}}var e=mw.$("#"+d).children(".mw-col").size(),o=100/e,p=o;mw.$("#"+d).children(".mw-col").width(p+"%")}}},saveOnce:!1,draftSaving:!1,save:function(a,b,c){var c=c||!1;mw.wysiwyg.undoredo&&(mw.$(".edit").addClass("orig_changed"),mw.wysiwyg.undoredo=!1);if(mw.isDrag||mw.pauseSave)return!1;if(c){mw.drag.saveOnce=!0;if(mw.$(".edit.changed").length==0)return $(mwd.body).removeClass("loading"),!1;if(mw.drag.draftSaving)return!1}else typeof saveStaticElementsStyles=="function"&&saveStaticElementsStyles();if(typeof a=="object"&&a!==null){if($(a).hasClass("disabled"))return!1;var d=a.innerHTML;c?$(a).addClass("disabled").html("Draft...").dataset("html",d):$(a).addClass("disabled").html("Saving...").dataset("html",d)}var e=mw.tools.parseHtml(mwd.body.innerHTML);mw.$(".element-current",e).removeClass("element-current"),mw.$(".element-active",e).removeClass("element-active"),mw.$(".disable-resize",e).removeClass("disable-resize"),mw.$(".empty-element",e).remove(),mw.$(".empty-element",e).remove(),mw.$(".edit .ui-resizable-handle",e).remove(),mw.tools.classNamespaceDelete("all","ui-",e),mw.$("[contenteditable]",e).removeAttr("contenteditable");if(c)var f=mw.$(".edit.changed",e);else{var f=$(".edit.changed",e);if(f.length==0)var f=$(".edit.orig_changed",e)}var g={};f.length>0&&f.each(function(a){a++;var b=$(this);($(this).attr("rel")==undefined||$(this).attr("rel")=="")&&$(this).dataset("rel")==""&&mw.tools.foreachParents(this,function(a){var c=this.className;mw.tools.hasClass(c,"edit")&&mw.tools.hasClass(c,"changed")&&(typeof this.attributes.rel!="undefined"||$(this).dataset("rel")!="")&&(b=$(this),mw.tools.stopLoop(a))});if(typeof b.attr("rel")!="undefined"&&b.attr("rel")!=""||b.dataset("rel")!=""){var c=b.html(),d={},e=b.get(0).attributes;if(e.length>0)for(var f=0;f<e.length;f++)temp1=e[f].nodeName,temp2=e[f].nodeValue,d[temp1]=temp2;var h={attributes:d,html:c},i="field_data_"+a,j=[{attributes:d},{html:c}];g[i]=h}});if(!mw.tools.isEmptyObject(g))c&&(g.is_draft=!0),mw.drag.draftSaving=!0,$.ajax({type:"POST",url:mw.settings.site_url+"api/save_edit",data:g,datatype:"json",async:!0,beforeSend:function(){},success:function(d){mw.drag.draftSaving=!1,c||(mw.askusertostay=!1),$("#mw-history-panel").is(":visible")==0&&mw.history.init();if(typeof a=="object"){var e=$(a).dataset("html");$(a).removeClass("disabled").html(e)}c?mw.$(".edit.changed").addClass("orig_changed").removeClass("changed"):mw.notification.success("All changes are saved."),typeof b=="function"&&b.call()},error:function(){mw.drag.draftSaving=!1,mw.$(".edit.changed").removeClass("changed orig_changed"),typeof a=="object"&&$(a).removeClass("disabled").html(mw.msg.save)},complete:function(){typeof a=="object"&&(mw.drag.draftSaving=!1,$(a).removeClass("disabled").html(mw.msg.save))}});else if(typeof a=="object"){var d=$(a).dataset("html");$(a).removeClass("disabled").html(d)}}},mw.pcWidthExtend=function(a,b,c,d,e){if(d<3)a.eq(e-1).width(c[e-1]+d+"%");else{var d=0;a.each(function(a){var e=$(this);c[a]=c[a]+b,d+=c[a],e.width(c[a]+"%")}),d<100&&mw.pcWidthExtend(a,b,c,d,e)}},mw.px2pc=function(a){var b=[],a=$(a),c=a.width(),d=a.children(".mw-col"),e=d.length;d.each(function(){var a=$(this),d=a.width()/c*100;b.push(d),a.css({width:d+"%"})}),mwcsum=0;var f=0;for(;f<e;f++)mwcsum+=b[f];var g=100-mwcsum;g!=0&&mw.pcWidthExtend(d,g/e,b,g,e)},mw.scale_cols=function(){$(".mw-row").each(function(){var a=$(this),b=a.children(".mw-col"),c=b.length,d=a.width(),e=0;b.each(function(){e+=$(this).width()});var f=d-e;if(f>6){var g=f/c;b.each(function(){$(this).width($(this).width()+g)}),mw.px2pc(this)}})},mw.delete_column=function(a){if(confirm(mw.settings.sorthandle_delete_confirmation_text)){var b=$(a).parents(".mw-row").eq(0),c=$(a).parents(".mw-col").eq(0);c.next(".mw-col").length==0&&c.prev(".mw-col").resizable("destroy"),c.remove(),b.find(".mw-col").length==0?b.remove():mw.px2pc(b[0])}},mw.resizable_columns=function(){$(".mw-row").each(function(){mw.px2pc(this)}),mw.$(".mw-col").each(function(){if(!mw.tools.hasClass(this.className,"ui-resizable")){$el_id_column=$(this).attr("id");if($el_id_column==undefined||$el_id_column=="undefined")$el_id_column="mw-column-"+mw.random(),$(this).attr("id",$el_id_column);$is_done=$(this).hasClass("ui-resizable"),$ds=mw.settings.drag_started,$is_done=!1;if($is_done==0){$inner_column=$(this).children(".mw-col:first"),$prow=$(this).parent(".mw-row").attr("id"),$no_next=!1,$also=$(this).next(".mw-col"),$also_check_exist=$also.size(),$also_check_exist==0&&($no_next=!0,$also=$(this).prev(".mw-col")),$also_el_id_column=$also.attr("id");if($also_el_id_column==undefined||$also_el_id_column=="undefined"||$also_el_id_column=="")$also_el_id_column="mw-column-"+mw.random(),$also.attr("id",$also_el_id_column);$also_reverse_id=$also_el_id_column,$also_inner_items=$inner_column.attr("id"),$no_next==0?$handles="e":$handles="none",$no_next==0&&($last_c_w=$(this).parent(".mw-row").children(".mw-col").last().width(),$row_max_w=$(this).parent(".mw-row").width(),$(this).attr("data-also-rezise-item",$also_reverse_id),mw.global_resizes={next:"",sum:0},$(this).resizable({handles:$handles,ghost:!1,containment:"parent",greedy:!0,cancel:".mw-sorthandle",minWidth:150,resize:function(a,b){mw.global_resizes.next.width(Math.floor(mw.global_resizes.sum-b.size.width-10)),mw.global_resizes.next.width()<151&&$(this).resizable("option","maxWidth",b.size.width),mw.settings.resize_started=!0;var c=$(this).width();$(this).find("img").each(function(){$(this).width()<=c?this.style.height="auto":""});var d=mw.global_resizes.next.width();mw.global_resizes.next.find("img").each(function(){$(this).width()<=c?this.style.height="auto":""})},create:function(a,b){var c=$(this);c.find(".ui-resizable-e:first").append('<span class="resize_arrows"></span>'),c.mousemove(function(a){c.children(".ui-resizable-e").find(".resize_arrows:first").css({top:a.pageY-c.offset().top+"px"})}),mw.px2pc(mw.tools.firstParentWithClass(this,"mw-row"))},start:function(a,b){$(mwd.body).addClass("Resizing"),$(this).resizable("option","maxWidth",9999),$(".mw-col",".edit").each(function(){$(this).removeClass("selected")}),mw.global_resizes.next=$(this).next().length>0?$(this).next():$(this).prev(),mw.global_resizes.sum=b.size.width+mw.global_resizes.next.width(),$r=$(this).parent(".mw-row"),$row_w=$r.width(),mw.resizable_row_width=$row_w,b.element.addClass("selected"),mw.settings.resize_started=!0,$(this).parent().addClass("mw_resizing"),$(mw.image_resizer).removeClass("active")},stop:function(a,b){$(this).parent().removeClass("mw_resizing"),mw.settings.resize_started=!1,mw.drag.fixes(),mw.drag.fix_placeholders(),mw.px2pc($(this).parents(".mw-row")[0]),$(mw.tools.firstParentWithClass(this,"edit")).addClass("changed orig_changed"),mw.askusertostay=!0,$(mwd.body).removeClass("Resizing")}}))}}})},mw.drop_regions={enabled:!1,ContainsDisabledSideClass:function(a){var b=["edit","mw-col","mw-row","mw-col-container"],c=0,d=b.length,e=a.className;if(e=="")return!0;for(;c<d;c++)if(mw.tools.hasClass(e,b[c]))return!0;return!1},dropTimeout:null,global_drop_is_in_region:!1,which:"none",create:function(a){var b=$(a),c=b.height(),d=b.width(),e=b.offset(),f={l:e.left,r:e.left+d*.1,t:e.top,b:e.top+c},g={l:e.left+d-d*.1,r:e.left+d,t:e.top,b:e.top+c};return{left:f,right:g}},is_in_region:function(a,b){var c=a.left,d=a.right,e=b.pageX,f=b.pageY;return e>c.l&&e<c.r&&f>c.t&&f<c.b?"left":e>d.l&&e<d.r&&f>d.t&&f<d.b?"right":"none"},init:function(a,b,c){mw.drop_regions.dropTimeout==null&&(mw.drop_regions.dropTimeout=setTimeout(function(){if(mw.drop_regions.enabled){var d=mw.drop_regions.create(a),e=mw.drop_regions.is_in_region(d,b);e=="left"&&!mw.drop_regions.ContainsDisabledSideClass(a)?(c.call(this,"left"),mw.drop_regions.global_drop_is_in_region=!0,mw.drop_regions.which="left"):e=="right"&&!mw.drop_regions.ContainsDisabledSideClass(a)?(c.call(this,"right"),mw.drop_regions.global_drop_is_in_region=!0,mw.drop_regions.which="right"):(mw.drop_regions.global_drop_is_in_region=!1,mw.drop_regions.which="none")}else mw.drop_regions.global_drop_is_in_region=!1,mw.drop_regions.which="none";mw.drop_regions.dropTimeout=null},37))}},mw.history={init:function(){data={},data.module="admin/mics/edit_block_history",data.page_id=mw.settings.page_id,data.post_id=mw.settings.post_id,data.no_wrap="1",data.category_id=mw.settings.category_id,data.for_url=document.location.href,mw.$("#mw-history-panel").load(mw.settings.site_url+"api/module",data)},load:function(a){mw.on.DOMChangePause=!0,a!=undefined&&$.ajax({type:"POST",url:mw.settings.site_url+"api/get_content_field_draft",data:{id:a},dataType:"json",success:function(a){if(a.constructor!==[].constructor)return!1;var b=a.length,c=0;for(;c<b;c++){var d=a[c];if(typeof d.field!="undefined"&&typeof d.rel!="undefined"){var e=d.field,f=d.rel;mw.$('.edit[rel="'+f+'"][field="'+e+'"]').html(d.value)}}mw.$(".edit.changed").removeClass("changed"),setTimeout(function(){mw.drag.fix_placeholders(!0),mw.resizable_columns(),mw.on.DOMChangePause=!1},200),mw.$(".hasdraft").remove()}})}},__createRow=function(a,b,c){var a=$(a),d=mwd.createElement("div");d.className="mw-row",d.id="row_"+mw.random(),d.innerHTML="<div class='mw-col temp_column' style='width:50%'><div class='mw-col-container'></div></div><div class='mw-col' style='width:50%'><div class='mw-col-container'></div></div>",a.before(d),a.addClass("element"),c=="left"?($(d).find(".mw-col-container").eq(0).append(b),$(d).find(".mw-col").eq(0).append('<div contenteditable="false" class="empty-element" id="mw-placeholder-'+mw.random()+'"><a class="delete_column" href="javascript:;" onclick="mw.delete_column(this);">Delete</a></div>'),$(d).find(".mw-col-container").eq(1).append(a),$(d).find(".mw-col").eq(1).append('<div contenteditable="false" class="empty-element" id="mw-placeholder-'+mw.random()+'"><a class="delete_column" href="javascript:;" onclick="mw.delete_column(this);">Delete</a></div>')):c=="right"&&($(d).find(".mw-col-container").eq(0).append(a),$(d).find(".mw-col").eq(0).append('<div contenteditable="false" class="empty-element" id="mw-placeholder-'+mw.random()+'"><a class="delete_column" href="javascript:;" onclick="mw.delete_column(this);">Delete</a></div>'),$(d).find(".mw-col-container").eq(1).append(b),$(d).find(".mw-col").eq(1).append('<div contenteditable="false" class="empty-element" id="mw-placeholder-'+mw.random()+'"><a class="delete_column" href="javascript:;" onclick="mw.delete_column(this);">Delete</a></div>')),setTimeout(function(){mw.drag.fix_placeholders(!0),mw.resizable_columns()},200)},dropInside=function(a){if(a.tagName=="IMG")return!1;if(!hasAbilityToDropElementsInside(a))return!1;var b=mw.CSSParser(a).get,c=b.background(),d=b.padding(!0),e=b.radius(!0),f=b.shadow(!0),g=b.border(!0);return c.color!="transparent"&&c.color!="rgba(0, 0, 0, 0)"||c.image!="none"?!0:d.top>0||d.right>0||d.bottom>0||d.left>0?!0:e.tl>0||e.tr>0||e.br>0||e.bl>0?!0:f.color!="none"?!0:g.top.width>0||g.right.width>0||g.bottom.width>0||g.left.width>0?!0:!1},mwd.body.className=mwd.body.className+" mw-live-edit",mw.designTool={position:function(a){var a=a||mw.$("#design_bnav");if(a.length==0)return!1;var b=$(window).width(),c=$(window).height(),d=a.offset(),e=a.width(),f=a.height(),g=d.left+e,h=d.top+f;g>b?a.css("left",b-e-20):"",h>c?a.css("top",c-f-20):""}},$(window).bind("load",function(){mw.$(".mw_dropdown_type_navigation a").each(function(){var a=$(this),b=a.parent();a.attr("href","javascript:;");var c=b.dataset("category-id");b.attr("value",c)}),mw.$("#module_category_selector").change(function(){var a=$(this).getDropdownValue();if(a=="all")return mw.$(".list-modules li").show(),!1;a!=-1&&a!="-1"?mw.tools.toolbar_sorter(Modules_List_modules,a):""}),mw.$("#elements_category_selector").change(function(){var a=$(this).getDropdownValue();if(a=="all")return mw.$(".list-elements li").show(),!1;a!=-1&&a!="-1"?mw.tools.toolbar_sorter(Modules_List_elements,a):""}),mw.$("#module_category_selector .dd_custom a").mousedown(function(a){mw.tools.toolbar_searh(Modules_List_modules,$(this).html()),mw.tools.firstParentWithClass(this,"mw_dropdown").querySelector(".mw_dropdown_val").innerHTML=$(this).html(),a.preventDefault()}),mw.$("#elements_category_selector .dd_custom a").mousedown(function(a){mw.tools.toolbar_searh(Modules_List_elements,$(this).html()),mw.tools.firstParentWithClass(this,"mw_dropdown").querySelector(".mw_dropdown_val").innerHTML=$(this).html(),a.preventDefault()}),mw.$("#design_bnav, .mw_ex_tools").addClass(mw.cookie.ui("designtool"));var a=mw.cookie.ui("designtool_position");if(a!=""){var a=a.split("|");mw.$("#design_bnav").css({top:a[0]+"px",left:a[1]+"px"})}mw.designTool.position(),mw.$(".mw_ex_tools").click(function(){var a=mw.$($(this).attr("href"));return a.toggleClass("active"),$(this).toggleClass("active"),mw.cookie.ui("designtool",a.hasClass("active")?"active":""),mw.designTool.position(a),!1}),mw.$(".ts_main_li").mouseenter(function(){mw.session.checkPause=!0,mw.pauseSave=!0;var a=mwd.querySelector(".element-current"),b=mw.tools.firstParentWithClass(a,"edit");$(b).addClass("changed");if(!mw.$("#design_bnav").hasClass("ui-draggable-dragging")){$(this).addClass("hovered"),mw.$(".ts_main_ul .ts_action").invisible(),mw.$(".ts_main_ul .ts_action").css({left:"100%",top:0});var c=mw.$(this.querySelector(".ts_action"));if(c.length===0)return!1;c.visible(),c.css("top",0);var d=c.offset(),e=c.outerWidth(),f=c.outerHeight(),g=$(window).width(),h=$(window).height(),i=$(window).scrollTop();c.css({left:d.left+e<g?"100%":-e,top:d.top+f-i<h?0:-(d.top+f-i-h)})}}),mw.$(".ts_main_li").mouseleave(function(){mw.pauseSave=!1,$(this).removeClass("hovered"),mw.session.checkPause=!1}),mw.$(".ts_main_li .ts_action_item").mouseenter(function(){$(this).parent().find(".ts_action").invisible(),$(this).parent().find(".ts_action").css("left","100%");var a=$(this).find(".ts_action:first"),b=a.offset();if(typeof b=="object"&&b!==null){var c=a.outerWidth(),d=$(window).width();b.left+c<d?a.css({left:"100%",visibility:"visible"}):a.css({left:-c,visibility:"visible"})}}),mw.$(".toolbar_bnav").hover(function(){$(this).addClass("toolbar_bnav_hover")},function(){$(this).removeClass("toolbar_bnav_hover")})}),mw.$(".ts_action_item").mouseenter(function(){var a=$(this).find(".ts_action:first");a.css({left:"100%",visibility:"visible"})}),$.fn.notmouseenter=function(){return this.filter(function(){var a=$(a),b=a.data("events");return b==undefined||b.mouseover==undefined||b.mouseover[0].origType!="mouseenter"})},$.fn.notclick=function(){return this.filter(function(){var a=$(a),b=a.data("events");return b==undefined||b.click==undefined})},$.expr[":"].isHidden=function(a,b,c,d){return mw.is.invisible(a)},$.expr[":"].isVisible=function(a,b,c,d){return window.getComputedStyle(a,null).visibility==="visible"},PagesFrameSRCSet=!1,$(document).ready(function(){mw.wysiwyg.prepare(),mw.wysiwyg.init(),mw.$(".edit a, #mw-toolbar-right a").click(function(){var a=this;if(!a.isContentEditable&&a.onclick===null&&a.href.indexOf("javascript:")!==0&&a.href!="#"&&$(a).attr("href").indexOf("#")!=0&&typeof a.attributes["href"]!="undefined")return mw.beforeleave(this.href)}),$(window).scroll(function(){$(window).scrollTop()>10?mw.tools.addClass(mwd.getElementById("live_edit_toolbar"),"scrolling"):mw.tools.removeClass(mwd.getElementById("live_edit_toolbar"),"scrolling")}),mw.$("#live_edit_toolbar").hover(function(){$(mwd.body).addClass("toolbar-hover")},function(){$(mwd.body).removeClass("toolbar-hover")})}),mw.toolbar={center_icons:function(){mw.$(".list-modules .mw_module_image img").each(function(){var a=window.getComputedStyle(this,null),b=parseFloat(a.height);b<32?$(this).css("marginTop",16-b/2):""})},fixPad:function(){mwd.body.style.paddingTop=mw.toolbar.minTop+mw.$("#live_edit_toolbar").height()+"px"}},mw.setLiveEditor=function(){$(mwd.querySelector(".editor_wrapper_tabled")).css({marginLeft:$(mwd.querySelector(".toolbar-sections-tabs")).outerWidth(!0),marginRight:$(mwd.querySelector("#mw-toolbar-right")).outerWidth(!0),left:0,width:$(window).width()-$(mwd.querySelector(".toolbar-sections-tabs")).outerWidth(!0)-$(mwd.querySelector("#mw-toolbar-right")).outerWidth(!0)})},$(window).bind("load",function(){mw.setLiveEditor(),mw.$("#history_dd").hover(function(){$(this).addClass("hover")},function(){$(this).removeClass("hover")}),mw.toolbar.center_icons(),mw.image.resize.init(".element-image"),$(mwd.body).mousedown(function(a){mw.$(".editor_hover").length==0&&($(mw.wysiwyg.external).empty().css("top","-9999px"),$(mwd.body).removeClass("hide_selection")),mw.$("#history_dd").hasClass("hover")||$("#historycontainer").hide(),mw.$(".toolbars-search.active").length===0?mw.$(".mw-autocomplete-cats").hide():mw.$(".mw-autocomplete-cats").show()}),mw.$("#liveedit_wysiwyg").mousedown(function(){mw.$(".mw_editor_btn_hover").length==0&&(mw.mouseDownOnEditor=!0,$(this).addClass("hover"))}),mw.$("#liveedit_wysiwyg").mouseup(function(){mw.mouseDownOnEditor=!1,$(this).removeClass("hover")}),$(document.body).mouseup(function(a){mw.target.item=a.target,mw.target.tag=a.target.tagName.toLowerCase(),mw.mouseDownOnEditor=!1,mw.SmallEditorIsDragging=!1,!mw.image.isResizing&&mw.target.tag!="img"&&mw.target.item.className!="image_change"&&$(mw.image_resizer).hasClass("active")&&$(mw.image_resizer).removeClass("active")}),mw.tools.sidebar();if(typeof mw.hasDraft=="object"){var a="<div class='hasdraft'><p>Load last Draft?</p><span class='mw-ui-btn mw-ui-btn-small mw-ui-btn-green' onclick='mw.history.load(\""+mw.hasDraft.draft+"\")'>Yes</span>"+"<span class='mw-ui-btn mw-ui-btn-small mw-ui-btn-red' onclick='$(this.parentNode).remove();'>No</span>"+"</div>";mw.$("#mw_tabs_small").after(a),setTimeout(function(){mw.$(".hasdraft").addClass("active")},1e4)}mw.toolbar.fixPad()}),$(window).resize(function(){mw.tools.module_slider.scale(),mw.tools.toolbar_slider.ctrl_show_hide(),mw.designTool.position(),mw.setLiveEditor()}),mw.preview=function(){var a=mw.url.removeHash(window.location.href),a=mw.url.set_param("preview",!0,a);window.open(a,"_blank"),window.focus()},mw.iphonePreview=function(){var a=mw.url.removeHash(window.location.href),a=mw.url.set_param("preview",!0,a);mw.tools.modal.frame({url:a,width:320,height:592,template:"modal-iphone"}),mw.tools.modal.overlay()},mw.quick={w:700,h:500,page:function(){var a=mw.tools.modal.frame({url:mw.settings.api_url+"module/?type=content/edit_page&live_edit=true&quick_edit=false&id=mw-quick-page&recommended_parent="+mw.settings.page_id,width:mw.quick.w,height:mw.quick.h,name:"quick_page",overlay:!0,title:"New Page"});a.overlay.style.backgroundColor="white"},category:function(){var a=mw.tools.modal.frame({url:mw.settings.api_url+"module/?type=categories/edit_category&live_edit=true&quick_edit=false&id=mw-quick-category&recommended_parent="+mw.settings.page_id,width:mw.quick.w,height:mw.quick.h,name:"quick_page",overlay:!0,title:"New Category"});a.overlay.style.backgroundColor="white"},edit:function(a){var b=mw.tools.modal.frame({url:mw.settings.api_url+"module/?type=content/edit_page&live_edit=true&quick_edit=false&is-current=true&id=mw-quick-page&content-id="+a,width:mw.quick.w,height:mw.quick.h,name:"quick_page",overlay:!0,title:"Edit content"});b.overlay.style.backgroundColor="white"},page_2:function(){var a=mw.tools.modal.frame({url:mw.settings.api_url+"module/?type=content/quick_add&live_edit=true&id=mw-new-content-add-ifame",width:mw.quick.w,height:mw.quick.h,name:"quick_page",overlay:!0,title:"New Page"});a.overlay.style.backgroundColor="white"},post:function(){var a=mw.tools.modal.frame({url:mw.settings.api_url+"module/?type=content/edit_page&live_edit=true&quick_edit=false&id=mw-quick-post&subtype=post&parent-page-id="+mw.settings.page_id,width:mw.quick.w,height:mw.quick.h,name:"quick_post",overlay:!0,title:"New Post"});a.overlay.style.backgroundColor="white"},product:function(){var a=mw.tools.modal.frame({url:mw.settings.api_url+"module/?type=content/edit_page&live_edit=true&quick_edit=false&id=mw-quick-product&subtype=product&parent-page-id="+mw.settings.page_id,width:mw.quick.w,height:mw.quick.h,name:"quick_product",overlay:!0,title:"New Product"});a.overlay.style.backgroundColor="white"}}